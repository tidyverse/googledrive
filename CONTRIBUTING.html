<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Contributing to googledrive • googledrive</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>

<!-- Bootstrap -->
<link href="tidyverse.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script>
<link href="tidyverse-2.css" rel="stylesheet">

<!--optional theme-->
<link href=".css" rel="stylesheet">




<meta property="og:title" content="Contributing to googledrive" />
<meta property="og:image" content="https://googledrive.tidyverse.org/logo.png" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script>

  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-title-body">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="index.html">googledrive</a>
        <div class="info hidden-xs hidden-sm">
          <span class="partof">part of the <a href="https://tidyverse.org">tidyverse</a></span>
          <span class="version version-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1.9000</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="articles/googledrive.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="articles/articles/bring-your-own-app.html">Bring your own OAuth app or API key</a>
    </li>
    <li>
      <a href="articles/articles/file-identification.html">File Identification</a>
    </li>
    <li>
      <a href="articles/articles/multiple-files.html">Dealing with multiple files</a>
    </li>
    <li>
      <a href="articles/articles/permissions.html">File permissions</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Blog posts</li>
    <li>
      <a href="https://www.tidyverse.org/blog/2019/08/googledrive-1-0-0/">Version 1.0.0</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="news/index.html">Change log</a>
    </li>
  </ul>
</li>
        <li>
  <a href="https://github.com/tidyverse/googledrive/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="contents col-md-9">
    <div class="page-header">
      <h1>Contributing to googledrive</h1>
    </div>

<div id="contributing-to-googledrive" class="section level1">

<ul>
<li><a href="#making-a-pull-request">Making a pull request</a></li>
<li><a href="#package-philosophy">Package philosophy</a></li>
<li>
<a href="#package-mechanics">Package mechanics</a>
<ul>
<li><a href="#documentation">Documentation</a></li>
<li><a href="#testing">Testing</a></li>
<li><a href="#continuous-integration">Continuous integration</a></li>
</ul>
</li>
<li><a href="#code-of-conduct">Code of Conduct</a></li>
</ul>
<div id="making-a-pull-request" class="section level2">
<h2 class="hasAnchor">
<a href="#making-a-pull-request" class="anchor"></a>Making a pull request</h2>
<ul>
<li>Uphold the design principles and package mechanics outlined below.</li>
<li>When in doubt, discuss in an issue before doing lots of work.</li>
<li>Make sure the package still passes <code>R CMD check</code> locally for you. It’s a good idea to do that before you touch anything, so you have a baseline.</li>
<li>Match the existing code style. Our intent is to follow <a href="https://style.tidyverse.org" class="uri">https://style.tidyverse.org</a>. Please use the <a href="https://styler.r-lib.org">styler package</a> to re-style any code that you touch.</li>
<li>Tests: please <em>try</em> to run our tests or at least those that exercise your PR. Add tests, if relevant. If things go sideways, just say so. We are painfully aware that it’s not easy to test API-wrapping, auth-requiring packages like googledrive and are open to constructive feedback. More below.</li>
<li>Documentation: Update the documentation source, if your PR changes any behavior. We use <a href="https://cran.r-project.org/package=roxygen2">roxygen2</a>, so you must edit the roxygen comments above the function; never edit <code>NAMESPACE</code> or <code>.Rd</code> files by hand. More below.</li>
<li>Website: The pkgdown-created website is built and deployed automatically via Travis-CI. Some changes require an edit to the <code>reference</code> section of <code>_pkgdown.yml</code>, i.e. to make sure that a function appears there.</li>
<li>If the PR is related to an issue, link to it in the description, with <a href="https://help.github.com/articles/autolinked-references-and-urls/">the <code>#15</code> syntax</a> and the issue slug for context. If the PR is meant to close an issue, make sure one of the commit messages includes <a href="https://help.github.com/articles/closing-issues-using-keywords/">text like <code>closes #44</code> or <code>fixes #101</code></a>. Provide the issue number and slug in the description, even if the issue is mentioned in the title, because auto-linking does not work in the PR title.
<ul>
<li>GOOD PR title: “Obtain user’s intent via mind-reading; fixes #86”.</li>
<li>BAD PR title: “Fixes #1043”. Please remind us all what issue #1043 is about!</li>
<li>BAD PR title: “Something about #345”. This will not actually close issue #345 upon merging. <a href="https://help.github.com/articles/closing-issues-using-keywords/">Use the magic words</a>.</li>
</ul>
</li>
<li>Add a bullet to <code>NEWS.md</code> with a concise description of the change, if it’s something a user would want to know when updating the package. <a href="https://github.com/tidyverse/dplyr/blob/master/NEWS.md">dplyr’s <code>NEWS.md</code></a> is a good source of examples. Note the sentence format, the inclusion of GitHub username, and links to relevant issue(s)/PR(s). We will handle any organization into sub-sections just prior to a release. What merits a bullet?
<ul>
<li>Fixing a typo in the docs does not, but it is still awesome and deeply appreciated.</li>
<li>Fixing a bug or adding a new feature is bullet-worthy.</li>
</ul>
</li>
</ul>
</div>
<div id="package-philosophy" class="section level2">
<h2 class="hasAnchor">
<a href="#package-philosophy" class="anchor"></a>Package philosophy</h2>
<ul>
<li>When in doubt, take a cue from the Unix file system commands or the Google Drive browser UI.</li>
<li>Have a reasonable default whenever humanly possible. This applies to auth, file name, file location, etc.</li>
<li>Be pipe-friendly.</li>
<li>If it’s not well-documented (e.g. working example!), it doesn’t really exist.</li>
<li>Accommodate initial file specification via path or name, but constantly push downstream work to be based on file id.</li>
<li>Return a tidy tibble, almost always a <a href="https://tidyverse.github.io/googledrive/reference/dribble.html"><code>dribble</code></a>, whenever it makes sense.</li>
</ul>
<p>There is a high-level interface for the typical user. These functions help you accomplish the most common tasks, hopefully in a natural way. Examples: <code><a href="reference/drive_find.html">drive_find()</a></code>, <code><a href="reference/drive_upload.html">drive_upload()</a></code>, <code><a href="reference/drive_download.html">drive_download()</a></code>. A few hand-picked functions support passing extra parameters through to the API request via <code>...</code>, but we don’t do this across the board.</p>
<p>There is also a low-level interface that is used internally. An example is the function <code><a href="reference/request_generate.html">request_generate()</a></code>. These functions are exported for use by programming-oriented users who are willing to read <a href="https://developers.google.com/drive/v3/web/about-sdk">Drive API docs</a> and want to do things we haven’t made available in the high-level interface.</p>
</div>
<div id="package-mechanics" class="section level2">
<h2 class="hasAnchor">
<a href="#package-mechanics" class="anchor"></a>Package mechanics</h2>
<div id="documentation" class="section level3">
<h3 class="hasAnchor">
<a href="#documentation" class="anchor"></a>Documentation</h3>
<p>We use <a href="https://cran.r-project.org/package=roxygen2">roxygen2</a>, specifically with the <a href="https://roxygen2.r-lib.org/articles/rd-formatting.html">Markdown syntax</a>, to create <code>NAMESPACE</code> and all <code>.Rd</code> files. All edits to documentation should be done in roxygen comments above the associated function or object.</p>
<p>Use templates or inheritance to repeat documentation whenever it is helpful, but without actually repeating its source.</p>
<p>Use internal and external links liberally, i.e. to other docs in googledrive or to Drive API resources.</p>
<p>We encourage working examples that include any necessary setup and teardown. In most cases, you’ll have to put them inside a <code>\dontrun{}</code>.</p>
<p>It’s nice if a pull request includes the result of running <code>devtools::document()</code>, to update <code>NAMESPACE</code> and the <code>.Rd</code> files, but that’s optional. A good reason to NOT <code>document()</code> is if you have a different version of roxygen2 installed and that sprays minor formatting changes across <code>.Rd</code> files that have nothing to do with the PR.</p>
</div>
<div id="testing" class="section level3">
<h3 class="hasAnchor">
<a href="#testing" class="anchor"></a>Testing</h3>
<p>We use <a href="https://cran.r-project.org/package=testthat">testthat</a>.</p>
<p>We have many tests that (1) require authorization and that (2) rely on the existence of specific files and folders. Therefore, to fully test googledrive, you have to do some setup.</p>
<p>For small changes, it’s fine to test your specific change locally and make a PR. Keep reading for an explanation of how to run full tests for googledrive.</p>
<div id="auth" class="section level4">
<h4 class="hasAnchor">
<a href="#auth" class="anchor"></a>Auth</h4>
<p>A token is put into force at the beginning of a test run by the first few lines of <a href="https://github.com/tidyverse/googledrive/blob/master/tests/testthat/helper.R">tests/testthat/helper.R</a>.</p>
<ul>
<li>This reflects the approach documented in the gargle vignette <a href="https://gargle.r-lib.org/articles/articles/managing-tokens-securely.html">Managing tokens securely</a>. We use embedded, encrypted service account token.</li>
<li>If you want to use a token you already have, edit those lines to use any of the techniques described in the gargle vignette <a href="https://gargle.r-lib.org/articles/non-interactive-auth.html">Non-interactive auth</a>. Don’t commit and submit this change as part of a pull request; just use it as a pragmatic way to run tests with a token you have on hand.</li>
</ul>
</div>
<div id="r-scripts-for-setup-and-clean" class="section level4">
<h4 class="hasAnchor">
<a href="#r-scripts-for-setup-and-clean" class="anchor"></a>R scripts for setup and clean</h4>
<p>For speed reasons, the googledrive tests expect to find certain pre-existing files and folders, i.e. we don’t do full setup and tear down on each run. You do setup at the beginning of your googledrive development and leave these files in place while you work. When you’re done, e.g., when your PR is complete, you can clean up these files. Each test run also creates and destroys files, both locally and on Drive, but that is different and not what we’re talking about here.</p>
<ol>
<li>
<p>Source <code>tests/testthat/driver.R</code> to extract and aggregate the current setup and clean code across all test files.</p>
<div class="sourceCode" id="cb1"><html><pre class="r"><span class="co">## gather all the test setup and clean code from individual test files</span>
<span class="fu"><a href="https://rdrr.io/r/base/source.html">source</a></span>(<span class="kw pkg">testthat</span><span class="kw ns">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/test_path.html">test_path</a></span>(<span class="st">"driver.R"</span>))
<span class="co">## leaves behind:</span>
<span class="co">##   * all-test-setup.R</span>
<span class="co">##   * all-test-clean.R</span></pre></html></div>
<ul>
<li>This creates two R scripts: <code>tests/testthat/all-test-setup.R</code> and <code>tests/testthat/all-test-clean.R</code>. Inspect them.</li>
</ul>
</li>
<li><p>When you are truly ready to perform setup or clean, edit the code to set the <code>SETUP</code> or <code>CLEAN</code> variable to <code>TRUE</code> instead of <code>FALSE</code>. This friction is intentional, so you don’t accidentally create or delete lots of Drive files without meaning to.</p></li>
<li><p>Render <code>all-test-setup.R</code> with the Knit button in RStudio or like so:</p></li>
</ol>
<!-- end list --><div class="sourceCode" id="cb2"><html><pre class="r"><span class="kw pkg">rmarkdown</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/rmarkdown/man/render.html">render</a></span>(<span class="kw pkg">testthat</span><span class="kw ns">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/test_path.html">test_path</a></span>(<span class="st">"all-test-setup.R"</span>))</pre></html></div>
<p>You could also just source it, but it’s nice to have a report that records what actually happened.</p>
<p>You should now be able to run the tests via <em>Build &gt; Test Package</em> or <em>Build &gt; Check Package</em> in RStudio or via <code>devtools::test()</code>.</p>
<p>You can leave the setup in place for as long as you’re working on googledrive, i.e. you don’t need to do this for every test run. In fact, that is the whole point!</p>
<p>When your googledrive development is over, render the clean script:</p>
<div class="sourceCode" id="cb3"><html><pre class="r"><span class="kw pkg">rmarkdown</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/rmarkdown/man/render.html">render</a></span>(<span class="kw pkg">testthat</span><span class="kw ns">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/test_path.html">test_path</a></span>(<span class="st">"all-test-clean.R"</span>))</pre></html></div>
<p>Again, read the report to look over what happened, in case anything was trashed that should not have been (btw, let us know about that so we can fix!). Once you’re satisfied that your own files were not touched, you can <code><a href="reference/drive_empty_trash.html">drive_empty_trash()</a></code> to truly delete the test files.</p>
</div>
<div id="adding-tests" class="section level4">
<h4 class="hasAnchor">
<a href="#adding-tests" class="anchor"></a>Adding tests</h4>
<p>If you’re going to add or modify tests, follow these conventions:</p>
<ul>
<li>Test files are marked up with knitr chunk headers in comments, e.g. <code># ---- clean ----</code> or <code># ---- tests ----</code>. This is what enables the <code>driver.R</code> script to isolate the setup or cleaning code. Don’t break that.</li>
<li>Any file that is truly necessary and can be setup in advance and persist? Do it, in order to make future test runs faster. Put the associated setup and clean code at the top of the test file.</li>
<li>All test files should have a name that documents why they exist and who made them. Use the <code># ---- nm_fun ----</code> chunk to define naming functions used in that test file (see existing files for examples). Always use one of these functions to generate file names. Use <code>nm_()</code> for test files that persist. Use <code>me_()</code> for ephemeral test files that are created and destroyed in one test run.</li>
</ul>
<p>Example and structure of a self-documenting name for a persistent test file:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>move<span class="op">-</span>files<span class="op">-</span>into<span class="op">-</span>me<span class="op">-</span>TEST<span class="op">-</span>drive<span class="op">-</span>mv</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="op">&lt;</span>informative<span class="op">-</span>slug<span class="op">&gt;-</span>TEST<span class="op">-</span><span class="er">&lt;</span>test<span class="op">-</span>context<span class="op">&gt;</span></span></code></pre></div>
<p>Example and structure of a self-documenting name for an ephemeral test file:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>DESCRIPTION<span class="op">-</span>TEST<span class="op">-</span>drive<span class="op">-</span>upload<span class="op">-</span>travis</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="op">&lt;</span>informative<span class="op">-</span>slug<span class="op">&gt;-</span>TEST<span class="op">-</span><span class="er">&lt;</span>test<span class="op">-</span>context<span class="op">&gt;-</span><span class="er">&lt;</span>user<span class="op">&gt;</span></span></code></pre></div>
<p>Note that the current user is appended! This is so that concurrent test runs do not attempt to edit the same files.</p>
</div>
</div>
<div id="continuous-integration" class="section level3">
<h3 class="hasAnchor">
<a href="#continuous-integration" class="anchor"></a>Continuous integration</h3>
<p>googledrive is checked on the current R release on Windows, via <a href="https://ci.appveyor.com/project/tidyverse/googledrive">AppVeyor</a>, and on several versions of R on Linux, via <a href="https://travis-ci.org/tidyverse/googledrive">Travis CI</a>. We use <a href="https://codecov.io/github/tidyverse/googledrive?branch=master">codecov</a> to track the test coverage. In general, the package is subjected to <code>R CMD check</code>, unit tests, and test coverage analysis after every push to GitHub. There are encrypted service account tokens on both AppVeyor and Travis CI, so tests against the Drive API can be run.</p>
<p>Things are a bit different for pull requests from outside contributors, however. These PRs do not have access to the encrypted tokens, therefore many tests must be skipped. The PR will still be vetted via <code>R CMD check</code> and tests that do not call the Drive API can still be run. After you make a PR, it’s a good idea to check back after a few minutes to see all of these results. If there are problems, read the log and try to correct the problem proactively. We “squash and merge” most pull requests, internal or external, so don’t agonize over the commit history.</p>
</div>
</div>
<div id="code-of-conduct" class="section level2">
<h2 class="hasAnchor">
<a href="#code-of-conduct" class="anchor"></a>Code of Conduct</h2>
<p>Please note that the googledrive project is released with a <a href="CODE_OF_CONDUCT.html">Contributor Code of Conduct</a>. By contributing to this project you agree to abide by its terms.</p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>

</div>



      <footer>
      <div class="tidyverse">
  <p>googledrive is a part of the <strong>tidyverse</strong>, an ecosystem of packages designed with common APIs and a shared philosophy. Learn more at <a href="https://tidyverse.org">tidyverse.org</a>.</p>
</div>

<div class="author">
  <p>
    Developed by Lucy D'Agostino McGowan, <a href='https://jennybryan.org'>Jennifer Bryan</a>, <a href='https://www.rstudio.com'><img src='https://www.tidyverse.org/rstudio-logo.svg' alt='RStudio' height='24' /></a>.
    Site built by <a href="https://pkgdown.r-lib.org">pkgdown</a>.
  </p>
</div>

      </footer>
   </div>

  


  </body>
</html>


